<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>ShuffleGame.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">Java03_Shuffle (Jan 16, 2022 9:29:23 PM)</a> &gt; <a href="../../index.html" class="el_group">Java03_Shuffle</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.source.html" class="el_package">shuff</a> &gt; <span class="el_source">ShuffleGame.java</span></div><h1>ShuffleGame.java</h1><pre class="source lang-java linenums">/*
 * ShuffleGame.java
 *
 * Created on February 27, 2008, 4:42 PM
 */

package shuff;

import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.*;
import java.util.*;
import java.util.Map.Entry;
import javax.swing.*;
import javax.swing.border.BevelBorder;
import javax.swing.border.SoftBevelBorder;
import javax.swing.border.TitledBorder;


/**
 *
 * @author  P.Sakthivel
 */
public class ShuffleGame extends JFrame implements ActionListener
{
    private static Random random ;
    static public int[] matrix ;
    
    private JButton[] buttonA ;
    
    public JPanel buttonPanel ;
    private JPanel footerPanel ;
    
    private JLabel emptyLabel ;
    private JLabel movesLabel ;
    private JLabel secondsCounterLabel ;
    
    public int blankPosition ;
    public int level ;
    private int noOfCells ;
    private int noOfMoves ;
    
    public JDialog helpDialog;
    
    private SecondsCounter secondsCounter_ ;
    private GridLayout gridLayout ;
    
    private static final int TOP = 0 ;
    private static final int LEFT = 1 ;
    private static final int RIGHT = 2 ;
    private static final int BOTTOM = 3 ;
    
    private static final int DEFAULT_LEVEL = 4 ;
    
    public static final String INIT_TIME = &quot;00 : 00&quot; ;
    private static final String CLOSE = &quot;CLOSE&quot; ;
    private static final String PAUSE = &quot;PAUSE&quot; ;
    private static final String START = &quot;START&quot; ;
    private static final String NUMBER = &quot;number&quot; ;
    private static final String fileName = &quot;Score.dat&quot; ;
    
    private static final boolean RUNNING = true ;
    private static final boolean IDLE = false ;
    
<span class="fc" id="L68">    public boolean gameStatus = IDLE ;</span>
    private JMenuItem reStartAction ;
    
    private static ShuffleGame shuffleGame_ ;
    
    /** Creates a new instance of ShuffleGame */
    public ShuffleGame( int levl )
    {
<span class="fc" id="L76">        super(&quot;ShuffleGame&quot;) ;</span>
<span class="fc" id="L77">        random = new Random() ;</span>
<span class="fc" id="L78">        level = levl ;</span>
<span class="fc" id="L79">        init( level ) ;</span>
<span class="fc" id="L80">        secondsCounter_ = new SecondsCounter() ;</span>
<span class="fc" id="L81">        getContentPane().add( getTopComponent() , BorderLayout.NORTH  ) ;</span>
<span class="fc" id="L82">        secondsCounter_.setLabel( secondsCounterLabel ) ;</span>
<span class="fc" id="L83">        getContentPane().add( initilizeButtonPanel( level ) , BorderLayout.CENTER ) ;</span>
<span class="fc" id="L84">        getContentPane().add( getFooterPanel() , BorderLayout.SOUTH ) ;</span>
        
<span class="fc" id="L86">        setDefaultCloseOperation( EXIT_ON_CLOSE ) ;</span>
<span class="fc" id="L87">        pack() ;</span>
<span class="fc" id="L88">        setResizable( false ) ;</span>
<span class="fc" id="L89">        setBounds( 200 , 200 , getWidth() , getHeight() ) ;</span>
<span class="fc" id="L90">        setVisible( true ) ;</span>
        
<span class="fc" id="L92">    }</span>
    
    public static void run( int level )
    {
<span class="fc bfc" id="L96" title="All 2 branches covered.">        if( shuffleGame_ != null )</span>
        {
<span class="fc" id="L98">            shuffleGame_.dispose() ;</span>
<span class="fc" id="L99">            shuffleGame_ = null ;</span>
        }
<span class="fc" id="L101">        shuffleGame_ = new ShuffleGame( level ) ;</span>
<span class="fc" id="L102">    }</span>
    
    public JPanel getFooterPanel()
    {
<span class="fc" id="L106">        AnimatedJButton pauseButton = new AnimatedJButton( PAUSE , level+4 ) ;</span>
<span class="fc" id="L107">        pauseButton.addActionListener( this ) ;</span>
<span class="fc" id="L108">        pauseButton.setActionCommand( PAUSE ) ;</span>
<span class="fc" id="L109">        footerPanel = new JPanel( new GridLayout(1,1)) ;</span>
<span class="fc" id="L110">        footerPanel.add( pauseButton ) ;</span>
<span class="fc" id="L111">        return footerPanel ;</span>
    }
    
    public JSplitPane getTopComponent()
    {
<span class="fc" id="L116">        JSplitPane splitPane = new JSplitPane( JSplitPane.HORIZONTAL_SPLIT ) ;</span>
<span class="fc" id="L117">        splitPane.setDividerSize( 1 ) ;</span>
<span class="fc" id="L118">        splitPane.setEnabled( false ) ;</span>
<span class="fc" id="L119">        JMenuBar menuBar = new JMenuBar() ;</span>
<span class="fc" id="L120">        menuBar.setBorder( new BevelBorder( BevelBorder.RAISED ) ) ;</span>
<span class="fc" id="L121">        JMenu shuffleMenu = new JMenu(&quot;Shuffle&quot;) ;</span>
<span class="fc" id="L122">        shuffleMenu.setMnemonic('S') ;</span>
<span class="fc" id="L123">        JMenu helpMenu = new JMenu(&quot;Help&quot;) ;</span>
<span class="fc" id="L124">        helpMenu.setMnemonic( 'H' ) ;</span>
        
<span class="fc" id="L126">        reStartAction = new JMenuItem( &quot;ReStart&quot; ) ;</span>
<span class="fc" id="L127">        reStartAction.setMnemonic( 'R' ) ;</span>
<span class="fc" id="L128">        reStartAction.addActionListener( this ) ;</span>
<span class="fc" id="L129">        JMenu levelMenu = new JMenu( &quot;Level&quot; ) ;</span>
<span class="fc" id="L130">        levelMenu.setMnemonic( 'L' ) ;</span>
<span class="fc" id="L131">        JMenuItem[] level = new JMenuItem[8] ;</span>
<span class="fc bfc" id="L132" title="All 2 branches covered.">        for( int i = 0 ; i &lt; 8 ; i++ )</span>
        {
<span class="fc" id="L134">            String title = String.valueOf( (i+3)).concat( &quot; X &quot; ).concat( String.valueOf( (i+3) ) ) ;</span>
<span class="fc" id="L135">            level[i] = new JMenuItem( title ) ;</span>
<span class="fc" id="L136">            level[i].setMnemonic( String.valueOf( (i+3) ).charAt(0) )  ;</span>
<span class="fc" id="L137">            String ac = &quot;level&quot;.concat( String.valueOf( (i) ) ) ;</span>
<span class="fc" id="L138">            level[i].setActionCommand( ac ) ;</span>
<span class="fc" id="L139">            level[i].addActionListener( this ) ;</span>
<span class="fc" id="L140">            levelMenu.add( level[i] ) ;</span>
        }
        
<span class="fc" id="L143">        JMenuItem scoreAction = new JMenuItem( &quot;High Scores&quot; ) ;</span>
<span class="fc" id="L144">        scoreAction.setMnemonic( 'H' ) ;</span>
<span class="fc" id="L145">        scoreAction.addActionListener( this ) ;</span>
<span class="fc" id="L146">        JMenuItem closeAction = new JMenuItem( &quot;Close&quot; ) ;</span>
<span class="fc" id="L147">        closeAction.setActionCommand( CLOSE ) ;</span>
<span class="fc" id="L148">        closeAction.setMnemonic( 'C' ) ;</span>
<span class="fc" id="L149">        closeAction.addActionListener( this ) ;</span>
        
<span class="fc" id="L151">        shuffleMenu.add( reStartAction ) ;</span>
<span class="fc" id="L152">        shuffleMenu.add( levelMenu ) ;</span>
<span class="fc" id="L153">        shuffleMenu.add( scoreAction ) ;</span>
<span class="fc" id="L154">        shuffleMenu.add( closeAction ) ;</span>
        
<span class="fc" id="L156">        JMenuItem helpAction = new JMenuItem( &quot;Instructions&quot; ) ;</span>
<span class="fc" id="L157">        helpAction.setMnemonic( 'I' ) ;</span>
<span class="fc" id="L158">        helpAction.addActionListener( this ) ;</span>
<span class="fc" id="L159">        JMenuItem aboutAction = new JMenuItem( &quot;About Shuffle&quot;) ;</span>
<span class="fc" id="L160">        aboutAction .setMnemonic( 'A' ) ;</span>
<span class="fc" id="L161">        aboutAction.addActionListener( this ) ;</span>
<span class="fc" id="L162">        helpMenu.add( helpAction ) ;</span>
<span class="fc" id="L163">        helpMenu.add( aboutAction ) ;</span>
<span class="fc" id="L164">        menuBar.add( shuffleMenu ) ;</span>
<span class="fc" id="L165">        menuBar.add( helpMenu ) ;</span>
        
<span class="fc" id="L167">        JPanel statusPanel = new JPanel( new GridLayout( 1 , 2 ) ) ;</span>
<span class="fc" id="L168">        JPanel timePanel = new JPanel( new GridLayout( 1 , 2 ) ) ;</span>
<span class="fc" id="L169">        JPanel movePanel = new JPanel( new GridLayout( 1 , 2 ) ) ;</span>
<span class="fc" id="L170">        statusPanel.add( timePanel ) ;</span>
<span class="fc" id="L171">        statusPanel.add( movePanel ) ;</span>
        
<span class="fc" id="L173">        timePanel.setBorder( new TitledBorder(&quot;&quot;) ) ;</span>
<span class="fc" id="L174">        movePanel.setBorder( new TitledBorder(&quot;&quot;) ) ;</span>
<span class="fc" id="L175">        JLabel timeLabel = new JLabel( &quot;Time ::&quot; , JLabel.CENTER ) ;</span>
        
<span class="fc" id="L177">        timePanel.add( timeLabel ) ;</span>
<span class="fc" id="L178">        timePanel.add( secondsCounterLabel = new JLabel( INIT_TIME , JLabel.CENTER ) ) ;</span>
<span class="fc" id="L179">        movePanel.add( new JLabel( &quot;Moves ::&quot; , JLabel.CENTER ) ) ;</span>
<span class="fc" id="L180">        movePanel.add( movesLabel = new JLabel(&quot;0&quot; , JLabel.CENTER ) ) ;</span>
        
<span class="fc" id="L182">        splitPane.setTopComponent( menuBar ) ;</span>
<span class="fc" id="L183">        splitPane.setBottomComponent( statusPanel ) ;</span>
<span class="fc" id="L184">        return splitPane ;</span>
    }
    
    public void init( int num )
    {
<span class="fc" id="L189">        level = num ;</span>
<span class="fc" id="L190">        noOfCells = level * level ;</span>
<span class="fc" id="L191">        gridLayout = new GridLayout( level , level ) ;</span>
<span class="fc" id="L192">        buttonA = new JButton[ noOfCells ] ;</span>
<span class="fc" id="L193">        buttonPanel = new JPanel() ;</span>
<span class="fc" id="L194">        buttonPanel.setOpaque( true ) ;</span>
<span class="fc" id="L195">        buttonPanel.setLayout(  gridLayout ) ;</span>
<span class="fc" id="L196">        emptyLabel = new JLabel() ;</span>
<span class="fc" id="L197">        emptyLabel.setBorder( new SoftBevelBorder( BevelBorder.LOWERED ) ) ;</span>
<span class="fc" id="L198">    }</span>
    
    public JPanel initilizeButtonPanel( int levl )
    {
<span class="fc" id="L202">        level = levl ;</span>
<span class="fc" id="L203">        noOfMoves = 0 ;</span>
<span class="fc" id="L204">        movesLabel.setText( &quot;0&quot; ) ;</span>
<span class="fc" id="L205">        secondsCounterLabel.setText( INIT_TIME ) ;</span>
<span class="fc" id="L206">        initMatrixToZero() ;</span>
<span class="fc" id="L207">        buttonPanel.removeAll() ;</span>
<span class="fc" id="L208">        int pivot = getNumberWithoutZero() ;</span>
<span class="fc bfc" id="L209" title="All 2 branches covered.">        for( int i = 0 ; i &lt; noOfCells ; i++ )</span>
        {
<span class="fc bfc" id="L211" title="All 2 branches covered.">            if( i != pivot )</span>
            {
<span class="fc" id="L213">                matrix[i] = getRandomNumber() ;</span>
<span class="fc" id="L214">                buttonA[i] = new JButton( String.valueOf( ( matrix[i] ) ) ) ;</span>
<span class="fc" id="L215">                buttonA[i].addActionListener( this ) ;</span>
<span class="fc" id="L216">                buttonA[i].setActionCommand( NUMBER ) ;</span>
<span class="fc" id="L217">                buttonPanel .add( buttonA[i] ) ;</span>
<span class="fc" id="L218">            }</span>
            else
            {
<span class="fc" id="L221">                buttonPanel.add( emptyLabel ) ;</span>
<span class="fc" id="L222">                blankPosition = pivot ;</span>
            }
        }
<span class="fc" id="L225">        repaintPanel() ;</span>
<span class="fc" id="L226">        return  buttonPanel ;</span>
    }
    
    public void initMatrixToZero()
    {
<span class="fc" id="L231">        matrix = new int[ noOfCells ] ;</span>
<span class="fc bfc" id="L232" title="All 2 branches covered.">        for( int i = 0 ; i &lt; noOfCells ; i++ )</span>
<span class="fc" id="L233">            matrix[i] = 0 ;</span>
<span class="fc" id="L234">    }</span>
    
    public int getRandomNumber()
    {
<span class="fc" id="L238">        int num = getNumberWithoutZero() ;</span>
<span class="fc bfc" id="L239" title="All 2 branches covered.">        return canAdd( num ) ? num : getRandomNumber() ;</span>
    }
    
    public int getNumberWithoutZero()
    {
<span class="fc" id="L244">        int num = random.nextInt( noOfCells ) ;</span>
<span class="fc bfc" id="L245" title="All 2 branches covered.">        return num != 0 ? num : getNumberWithoutZero() ;</span>
    }
    
    /* condition , to fill nos. without duplicate */
    public boolean canAdd( int num )
    {
<span class="fc" id="L251">        boolean canAdd = true ;</span>
<span class="fc bfc" id="L252" title="All 4 branches covered.">        for( int i = 0 ; i &lt; noOfCells - 1 &amp;&amp; canAdd ; i++ )</span>
<span class="fc bfc" id="L253" title="All 2 branches covered.">            canAdd = matrix[i] != num ;</span>
<span class="fc" id="L254">        return canAdd ;</span>
    }
    
    public static void main(String[] args)
    {
<span class="fc" id="L259">        ShuffleGame.run( 4 ) ;</span>
<span class="fc" id="L260">    }</span>
    
    public int getPosition( int btnNumber )
    {
<span class="fc bfc" id="L264" title="All 2 branches covered.">        for( int i = 0 ; i &lt; noOfCells ; i++ )</span>
        {
<span class="fc bfc" id="L266" title="All 2 branches covered.">            if( matrix[i] == btnNumber )</span>
            {
<span class="fc" id="L268">                return i ;</span>
            }
        }
<span class="fc" id="L271">        return 0 ;</span>
    }
    
    public void repaintPanel()
    {
<span class="fc" id="L276">        pack();</span>
<span class="fc" id="L277">    }</span>
    
    public void startSecondsCounter()
    {
<span class="fc" id="L281">        secondsCounter_.start() ;</span>
<span class="fc" id="L282">    }</span>
    
    public void setGameStatus( boolean status )
    {
<span class="fc" id="L286">        gameStatus = status ;</span>
<span class="fc" id="L287">    }</span>
    
    /*Set Button stated enable and disable while pasuse*/
    public void changeButtonState( boolean state )
    {
<span class="fc bfc" id="L292" title="All 2 branches covered.">        for( int i = 0 ; i &lt; buttonA.length ; i++ )</span>
        {
<span class="pc bpc" id="L294" title="1 of 2 branches missed.">            if( buttonA[i] != null )</span>
            {
<span class="fc bfc" id="L296" title="All 2 branches covered.">                if( state )</span>
                {
<span class="fc" id="L298">                    buttonA[i].setText( buttonA[i].getActionCommand() ) ;</span>
<span class="fc" id="L299">                    buttonA[i].setActionCommand( NUMBER ) ;</span>
<span class="fc" id="L300">                }</span>
                else
                {
<span class="fc" id="L303">                    buttonA[i].setActionCommand( buttonA[i].getText() ) ;</span>
<span class="fc" id="L304">                    buttonA[i].setText( &quot;Zzzz....&quot; ) ;</span>
                }
<span class="fc" id="L306">                reStartAction.setEnabled( state ) ;</span>
<span class="fc" id="L307">                buttonA[i].setEnabled( state ) ;</span>
            }
        }
<span class="fc" id="L310">    }</span>
    
    public void actionPerformed(ActionEvent e)
    {
<span class="fc" id="L314">        String actionCommand = e.getActionCommand() ;</span>
<span class="fc bfc" id="L315" title="All 2 branches covered.">        if ( actionCommand == PAUSE )</span>
        {
<span class="fc" id="L317">            secondsCounter_.pause() ;</span>
<span class="fc" id="L318">            changeButtonState( false ) ;</span>
<span class="fc" id="L319">            AnimatedJButton btn = ( AnimatedJButton ) e.getSource() ;</span>
<span class="fc" id="L320">            btn.setLabelName( START ) ;</span>
<span class="fc" id="L321">            btn.setActionCommand( START ) ;</span>
<span class="fc" id="L322">        }</span>
<span class="fc bfc" id="L323" title="All 2 branches covered.">        else if( actionCommand.equals( START ) )</span>
        {
<span class="fc" id="L325">            secondsCounter_.enable() ;</span>
<span class="fc" id="L326">            changeButtonState( true ) ;</span>
<span class="fc" id="L327">            AnimatedJButton btn = ( AnimatedJButton ) e.getSource() ;</span>
<span class="fc" id="L328">            setGameStatus( RUNNING ) ;</span>
<span class="fc" id="L329">            btn.setLabelName( PAUSE ) ;</span>
<span class="fc" id="L330">            btn.setActionCommand( PAUSE ) ;</span>
<span class="fc" id="L331">        }</span>
<span class="fc bfc" id="L332" title="All 2 branches covered.">        else if( actionCommand.equals(&quot;ReStart&quot;) )</span>
        {
<span class="fc" id="L334">            initilizeButtonPanel( level ) ;</span>
<span class="fc" id="L335">            secondsCounter_.stop() ;</span>
<span class="fc" id="L336">            setGameStatus( IDLE ) ;</span>
<span class="fc" id="L337">            repaintPanel() ;</span>
<span class="fc" id="L338">        }</span>
<span class="fc bfc" id="L339" title="All 2 branches covered.">        else if( actionCommand.equals( CLOSE ) )</span>
        {
<span class="fc" id="L341">            secondsCounter_.stop() ;</span>
<span class="fc" id="L342">            secondsCounter_.finalize() ;</span>
<span class="fc" id="L343">            shuffleGame_.dispose() ;</span>
<span class="fc" id="L344">        }</span>
<span class="fc bfc" id="L345" title="All 2 branches covered.">        else if ( actionCommand.substring(0,5).equals(&quot;level&quot;) )</span>
        {
            /* eleminate int value from string for ex., 5 from &quot;level5&quot; */
<span class="fc" id="L348">            int _level = Integer.parseInt( actionCommand.substring(5,6) ) ;</span>
<span class="fc bfc" id="L349" title="All 2 branches covered.">            for( int i = 0 ; i &lt;= 8 ; i++ ) /* Zero starts from level 3 */</span>
            {
<span class="fc bfc" id="L351" title="All 2 branches covered.">                if( _level == i )</span>
                {
<span class="fc" id="L353">                    ShuffleGame.run( i+3 ) ;</span>
                }
            }
<span class="fc" id="L356">        }</span>
<span class="fc bfc" id="L357" title="All 2 branches covered.">        else if ( actionCommand.equals( NUMBER ) )</span>
        {
<span class="fc" id="L359">            JButton button = ( JButton ) e.getSource() ;</span>
<span class="fc" id="L360">            int btnNumber = Integer.parseInt( button.getText() ) ;</span>
<span class="fc" id="L361">            int pos = getPosition( btnNumber )  ;</span>
<span class="fc" id="L362">            JButton btn = ( JButton ) buttonPanel.getComponent( pos ) ;</span>
<span class="fc" id="L363">            JLabel label = getComponentIfPossibleToMove( pos ) ;</span>
<span class="pc bpc" id="L364" title="1 of 2 branches missed.">            if( label != null )</span>
            {
<span class="fc bfc" id="L366" title="All 2 branches covered.">                if( gameStatus == IDLE )</span>
                {
<span class="fc" id="L368">                    setGameStatus( RUNNING ) ;</span>
<span class="fc" id="L369">                    startSecondsCounter() ;</span>
                }
<span class="fc" id="L371">                buttonPanel.add( label , pos ) ;</span>
<span class="fc" id="L372">                buttonPanel.add( btn , blankPosition ) ;</span>
<span class="fc" id="L373">                matrix[pos] = 0 ;</span>
<span class="fc" id="L374">                matrix[ blankPosition ] = btnNumber ;</span>
<span class="fc" id="L375">                blankPosition = pos ;</span>
<span class="fc" id="L376">                noOfMoves += 1 ;</span>
<span class="fc" id="L377">                movesLabel.setText( String.valueOf( noOfMoves ) ) ;</span>
<span class="fc" id="L378">                repaintPanel() ;</span>
<span class="fc bfc" id="L379" title="All 2 branches covered.">                if( blankPosition == noOfCells - 1 )</span>
                {
<span class="pc bpc" id="L381" title="1 of 2 branches missed.">                    if( analyseResult() )</span>
                    {
<span class="fc" id="L383">                        String etStr = secondsCounter_.getTimeElapsed() ;</span>
<span class="fc" id="L384">                        int time = secondsCounter_.getTimeElapsedInSeconds() ;</span>
<span class="fc" id="L385">                        secondsCounter_.stop() ;</span>
<span class="fc" id="L386">                        gameStatus = IDLE ;</span>
<span class="fc" id="L387">                        JOptionPane.showMessageDialog( ShuffleGame.this , &quot;&lt;html&gt; &lt;b color ='red'&gt; WellDone...! you have finished &lt;br&gt; within &quot;.concat( etStr ) ) ;</span>
<span class="fc" id="L388">                        showScoreDialog( noOfMoves , time ) ;</span>
<span class="fc" id="L389">                        initilizeButtonPanel( level ) ;</span>
                    }
                }
                
            }
<span class="fc" id="L394">        }</span>
<span class="fc bfc" id="L395" title="All 2 branches covered.">        else if ( actionCommand.equals( &quot;Instructions&quot; ) )</span>
        {
<span class="fc" id="L397">            showImageDialog( &quot;.\\Image\\Help.png&quot; , &quot;Instructions&quot; ) ;</span>
<span class="fc" id="L398">        }</span>
<span class="fc bfc" id="L399" title="All 2 branches covered.">        else if ( actionCommand.equals( &quot;About Shuffle&quot; ) )</span>
        {
<span class="fc" id="L401">            showImageDialog( &quot;.\\Image\\About.png&quot; , &quot;Shuffle Game - Version 1.0&quot; ) ;</span>
<span class="fc" id="L402">        }</span>
<span class="pc bpc" id="L403" title="1 of 2 branches missed.">        else if( actionCommand.equals(&quot;High Scores&quot;) )</span>
        {
<span class="fc" id="L405">            showHighScoreDialog() ;</span>
        }
<span class="fc" id="L407">    }</span>
    
    public void showHighScoreDialog()
    {
        try
        {
<span class="fc" id="L413">            File file = new File( fileName ) ;</span>
<span class="fc bfc" id="L414" title="All 2 branches covered.">            if ( file.isFile() )</span>
            {
<span class="fc" id="L416">                FileInputStream fis = new FileInputStream( file ) ;</span>
<span class="fc" id="L417">                ObjectInputStream ois = new ObjectInputStream( fis ) ;</span>
<span class="fc" id="L418">                Object obj = ois.readObject() ;</span>
<span class="pc bpc" id="L419" title="1 of 2 branches missed.">                if( obj instanceof TreeMap )</span>
                {
<span class="fc" id="L421">                    TreeMap map = ( TreeMap ) obj ;</span>
                    Entry entry  ;
<span class="fc" id="L423">                    Iterator itr = map.entrySet().iterator() ;</span>
                    Credits credits ;
<span class="fc" id="L425">                    JPanel scoreBoardPanel = new JPanel( new GridLayout( map.size()+1 , 4 ) ) ;</span>
<span class="fc" id="L426">                    scoreBoardPanel.setEnabled( false ) ;</span>
<span class="fc" id="L427">                    scoreBoardPanel.add( new JLabel( &quot;Level&quot; ) ) ;</span>
<span class="fc" id="L428">                    scoreBoardPanel.add( new JLabel( &quot;Player&quot; ) ) ;</span>
<span class="fc" id="L429">                    scoreBoardPanel.add( new JLabel( &quot;Time&quot; ) ) ;</span>
<span class="fc" id="L430">                    scoreBoardPanel.add( new JLabel( &quot;Moves&quot; ) ) ;</span>
<span class="fc" id="L431">                    JTextField tField = new JTextField () ;</span>
<span class="fc" id="L432">                    tField.setEditable( false ) ;</span>
<span class="fc bfc" id="L433" title="All 2 branches covered.">                    while( itr.hasNext() )</span>
                    {
<span class="fc" id="L435">                        entry = ( Entry ) itr.next() ;</span>
<span class="fc" id="L436">                        Integer _level = ( Integer ) entry.getKey() ;</span>
<span class="fc" id="L437">                        TreeSet levelSet = ( TreeSet ) entry.getValue() ;</span>
<span class="fc" id="L438">                        credits = ( Credits ) levelSet .first() ;</span>
<span class="fc" id="L439">                        scoreBoardPanel.add( tField = new JTextField ( String.valueOf( credits.getLevel() ) ) ) ;</span>
<span class="fc" id="L440">                        tField.setEditable( false ) ;</span>
<span class="fc" id="L441">                        scoreBoardPanel.add( tField = new JTextField ( credits.getPlayer() ) ) ;</span>
<span class="fc" id="L442">                        tField.setEditable( false ) ;</span>
<span class="fc" id="L443">                        scoreBoardPanel.add( tField = new JTextField ( credits.getTime() ) ) ;</span>
<span class="fc" id="L444">                        tField.setEditable( false ) ;</span>
<span class="fc" id="L445">                        scoreBoardPanel.add( tField = new JTextField ( String.valueOf( credits.getMoves() ) ) ) ;</span>
<span class="fc" id="L446">                        tField.setEditable( false ) ;</span>
                    }
<span class="fc" id="L448">                    JDialog highScoreDialog = new JDialog( ShuffleGame.this , &quot;High Scores&quot; , true ) ;</span>
<span class="fc" id="L449">                    highScoreDialog.getContentPane().add( scoreBoardPanel , BorderLayout.CENTER ) ;</span>
<span class="fc" id="L450">                    highScoreDialog.getContentPane().add(  getCloseButtonPanel( highScoreDialog ) , BorderLayout.SOUTH ) ;</span>
<span class="fc" id="L451">                    highScoreDialog.pack() ;</span>
<span class="fc" id="L452">                    highScoreDialog.setBounds( getX() , getY() , highScoreDialog.getWidth() ,  highScoreDialog.getHeight() ) ;</span>
<span class="fc" id="L453">                    highScoreDialog.setVisible( true ) ;</span>
<span class="fc" id="L454">                }</span>
                else
                {
<span class="nc" id="L457">                    showWarrningDialog() ;</span>
                }
<span class="nc" id="L459">            }</span>
            else
            {
<span class="fc" id="L462">                JOptionPane.showMessageDialog( ShuffleGame.this , &quot;Score board is empty&quot; ) ;</span>
            }
<span class="fc" id="L464">        }</span>
<span class="nc" id="L465">        catch ( Exception e )</span>
        {
<span class="nc" id="L467">            showWarrningDialog() ;</span>
        }
<span class="fc" id="L469">    }</span>
    
    public void showWarrningDialog()
    {
<span class="nc" id="L473">        JOptionPane.showMessageDialog( ShuffleGame.this , &quot;Score data file is corrupted\nplease delete the Score.dat \n file and run the game&quot; ) ;</span>
<span class="nc" id="L474">    }</span>
    
    public void showScoreDialog( int moves , int seconds )
    {
<span class="fc" id="L478">        TreeSet set = null ;</span>
<span class="fc" id="L479">        TreeMap map = null ; /* Map = [ level , [ set = [ credit1,2,3..10 ] ] ] */</span>
        try
        {
<span class="fc" id="L482">            File file = new File( fileName ) ;</span>
<span class="fc bfc" id="L483" title="All 2 branches covered.">            if ( file.isFile() )</span>
            {
<span class="fc" id="L485">                FileInputStream fis = new FileInputStream( file ) ;</span>
<span class="fc" id="L486">                ObjectInputStream ois = new ObjectInputStream( fis ) ;</span>
<span class="fc" id="L487">                Object obj = ois.readObject() ;</span>
<span class="pc bpc" id="L488" title="1 of 2 branches missed.">                if( obj instanceof TreeMap )</span>
                {
<span class="fc" id="L490">                    map = ( TreeMap ) obj ;</span>
<span class="fc" id="L491">                    set = ( TreeSet ) map.get( new Integer( level ) ) ;</span>
<span class="pc bpc" id="L492" title="1 of 2 branches missed.">                    if( set != null )</span>
                    {
<span class="fc" id="L494">                        Credits newCredits = new Credits( seconds , moves , level ) ;</span>
<span class="fc bfc" id="L495" title="All 2 branches covered.">                        if( set.size() &lt; 10 )</span>
                        {
<span class="fc" id="L497">                            set.add( newCredits ) ;</span>
<span class="fc" id="L498">                        }</span>
                        else
                        {
<span class="fc" id="L501">                            List list = new ArrayList( set ) ;</span>
<span class="fc" id="L502">                            Credits c = ( Credits ) list.get( 9 ) ;</span>
<span class="pc bpc" id="L503" title="1 of 2 branches missed.">                            if( c.getTimeInSeconds() &gt;= seconds )</span>
                            {
<span class="pc bpc" id="L505" title="3 of 4 branches missed.">                                if( c.getTimeInSeconds() &gt; seconds || c.getMoves() &gt; moves )</span>
                                {
<span class="fc" id="L507">                                    list.remove( 9 ) ;</span>
<span class="fc" id="L508">                                    list.add( newCredits ) ;</span>
<span class="fc" id="L509">                                    set.clear() ;</span>
<span class="fc" id="L510">                                    set.addAll( list ) ;</span>
                                }
                            }
                        }
<span class="fc" id="L514">                    }</span>
                    else
                    {
<span class="nc" id="L517">                        set = new TreeSet() ;</span>
<span class="nc" id="L518">                        set.add( new Credits( seconds , moves , level ) ) ;</span>
<span class="nc" id="L519">                        map.put( new Integer( level ) , set ) ;</span>
                    }
                    
<span class="fc" id="L522">                    file.delete() ;</span>
<span class="fc" id="L523">                    file = new File( fileName ) ;</span>
<span class="fc" id="L524">                }</span>
                else
                {
<span class="nc" id="L527">                    showWarrningDialog() ;</span>
                }
<span class="fc" id="L529">                ois.close() ;</span>
<span class="fc" id="L530">                fis.close() ;</span>
<span class="fc" id="L531">            }</span>
            else
            {
<span class="fc" id="L534">                set = new TreeSet() ;</span>
<span class="fc" id="L535">                set.add( new Credits( seconds , moves , level ) ) ;</span>
<span class="fc" id="L536">                map = new TreeMap() ;</span>
<span class="fc" id="L537">                map.put( new Integer( level ) , set ) ;</span>
                
            }
            
<span class="fc" id="L541">            showScoreDialog( set ) ;</span>
<span class="fc" id="L542">            FileOutputStream fos = new FileOutputStream( file ) ;</span>
<span class="fc" id="L543">            ObjectOutputStream ous = new ObjectOutputStream( fos ) ;</span>
<span class="fc" id="L544">            ous.writeObject( map ) ;</span>
<span class="fc" id="L545">            ous.close() ;</span>
<span class="fc" id="L546">            fos.close() ;</span>
            
<span class="fc" id="L548">        }</span>
<span class="nc" id="L549">        catch( Exception e )</span>
        {
<span class="nc" id="L551">            e.printStackTrace() ;</span>
<span class="nc" id="L552">            showWarrningDialog() ;</span>
        }
<span class="fc" id="L554">    }</span>
    
    public void showScoreDialog( final TreeSet scoreSet )
    {
<span class="fc" id="L558">        final JDialog scoreDialog = new JDialog( ShuffleGame.this , &quot;High Scores&quot; , true ) ;</span>
<span class="pc bpc" id="L559" title="1 of 2 branches missed.">        if( scoreSet == null )</span>
        {
<span class="nc" id="L561">            return ;</span>
        }
        
<span class="fc" id="L564">        int size = scoreSet.size() ;</span>
<span class="fc" id="L565">        JPanel panel = new JPanel( new GridLayout( size+1 , 4 ) ) ;</span>
<span class="fc" id="L566">        final JTextField text[][] = new JTextField[ size ][4] ;</span>
<span class="fc" id="L567">        panel.add( new JLabel( &quot;Sr.No&quot; ) ) ;</span>
<span class="fc" id="L568">        panel.add( new JLabel( &quot;Player&quot; ) ) ;</span>
<span class="fc" id="L569">        panel.add( new JLabel( &quot;Time&quot; ) ) ;</span>
<span class="fc" id="L570">        panel.add( new JLabel( &quot;No.of Moves&quot; ) ) ;</span>
        
<span class="fc" id="L572">        List list = new ArrayList( scoreSet ) ;</span>
<span class="fc" id="L573">        int pos = -1 ;</span>
<span class="fc" id="L574">        Credits c1 = null , c ;</span>
<span class="fc bfc" id="L575" title="All 2 branches covered.">        for ( int i = 0 ; i &lt; size ; i++ )</span>
        {
<span class="fc" id="L577">            c = ( Credits ) list.get(i) ;</span>
<span class="fc" id="L578">            text[i][0] = new JTextField( String.valueOf( i+1) ) ;</span>
<span class="fc" id="L579">            text[i][0] .setEditable( false ) ;</span>
<span class="fc" id="L580">            text[i][1] = new JTextField( c.getPlayer() , 10 ) ;</span>
<span class="fc bfc" id="L581" title="All 2 branches covered.">            if( c.getPlayer().equals(&quot;&quot;) )</span>
            {
<span class="fc" id="L583">                pos = i ;</span>
<span class="fc" id="L584">                c1 = c ;</span>
<span class="fc" id="L585">                String st = &quot;Enter your Name&quot;;</span>
<span class="fc" id="L586">                text[i][1].setText(st) ;</span>
<span class="fc" id="L587">                text[i][1].select(0 , st.length() ) ;</span>
<span class="fc" id="L588">                text[i][1].setEditable( true ) ;</span>
<span class="fc" id="L589">            }</span>
            else
            {
<span class="fc" id="L592">                text[i][1] .setEditable( false ) ;</span>
            }
<span class="fc" id="L594">            text[i][2] = new JTextField( c.getTime() , 6 ) ;</span>
<span class="fc" id="L595">            text[i][2] .setEditable( false ) ;</span>
<span class="fc" id="L596">            text[i][3] = new JTextField( String.valueOf( c.getMoves() ) , 5 ) ;</span>
<span class="fc" id="L597">            text[i][3] .setEditable( false ) ;</span>
            
<span class="fc" id="L599">            panel.add( text[i][0] ) ;</span>
<span class="fc" id="L600">            panel.add( text[i][1] ) ;</span>
<span class="fc" id="L601">            panel.add( text[i][2] ) ;</span>
<span class="fc" id="L602">            panel.add( text[i][3] ) ;</span>
        }
        
<span class="fc" id="L605">        final JButton okButton = new JButton( &quot;OK&quot; ) ;</span>
<span class="fc" id="L606">        okButton.setMnemonic('O') ;</span>
<span class="pc bpc" id="L607" title="1 of 2 branches missed.">        if( pos == -1 )</span>
<span class="nc" id="L608">            return ;</span>
<span class="fc" id="L609">        okButton.setNextFocusableComponent( text[pos][1] ) ;</span>
<span class="fc" id="L610">        final Credits c2 = c1 ;</span>
<span class="fc" id="L611">        final int ps = pos ;</span>
<span class="fc" id="L612">        ActionListener scoreBoardListener = new ActionListener()</span>
        {
            public void actionPerformed( ActionEvent e )
            {
<span class="fc" id="L616">                Object source = e.getSource() ;</span>
<span class="fc bfc" id="L617" title="All 2 branches covered.">                if ( source instanceof JButton )</span>
                {
<span class="fc" id="L619">                    String name = text[ps][1].getText() ;</span>
<span class="pc bpc" id="L620" title="1 of 2 branches missed.">                    if( ! name.equals( &quot;&quot; ) )</span>
                    {
<span class="fc" id="L622">                        c2.setPlayer( name ) ;</span>
<span class="fc" id="L623">                        scoreSet.add( c2 ) ;</span>
<span class="fc" id="L624">                        scoreDialog.dispose() ;</span>
<span class="fc" id="L625">                        return ;</span>
                    }
                }
<span class="pc bpc" id="L628" title="1 of 2 branches missed.">                else if ( source instanceof JTextField )</span>
                {
<span class="fc" id="L630">                    JTextField tF = ( JTextField ) source ;</span>
<span class="fc bfc" id="L631" title="All 2 branches covered.">                    if( ! tF.getText().equals(&quot;&quot;) )</span>
                    {
<span class="fc" id="L633">                        okButton.doClick() ;</span>
<span class="fc" id="L634">                        return ;</span>
                    }
                }
<span class="fc" id="L637">                JOptionPane.showMessageDialog( scoreDialog , &quot;Null Name Not Allowed&quot; ) ;</span>
<span class="fc" id="L638">                text[ps][1].requestFocus() ;</span>
<span class="fc" id="L639">                return ;</span>
            }
        } ;
        
<span class="fc" id="L643">        okButton.addActionListener( scoreBoardListener ) ;</span>
        
<span class="fc" id="L645">        JPanel closeButtonPanel = new JPanel() ;</span>
<span class="fc" id="L646">        closeButtonPanel.add( okButton ) ;</span>
<span class="fc" id="L647">        closeButtonPanel.setBorder( new BevelBorder( BevelBorder.RAISED )) ;</span>
        
<span class="fc" id="L649">        scoreDialog.getContentPane().add( panel , BorderLayout.CENTER ) ;</span>
<span class="fc" id="L650">        scoreDialog.getContentPane().add( closeButtonPanel , BorderLayout.SOUTH ) ;</span>
<span class="fc" id="L651">        scoreDialog.pack();</span>
<span class="fc" id="L652">        text[pos][1].addActionListener( scoreBoardListener ) ;</span>
<span class="fc" id="L653">        text[pos][1].selectAll() ;</span>
<span class="fc" id="L654">        text[pos][1].requestFocus() ;</span>
<span class="fc" id="L655">        scoreDialog.setBounds( getX() , getY() , scoreDialog.getWidth() ,  scoreDialog.getHeight() ) ;</span>
<span class="fc" id="L656">        scoreDialog.setVisible( true ) ;</span>
<span class="fc" id="L657">    }</span>
    
    public void showImageDialog( String imageName , String title )
    {
<span class="fc" id="L661">        helpDialog = new JDialog( ShuffleGame.this , title , true ) ;</span>
<span class="fc" id="L662">        ImageIcon icon = new ImageIcon( imageName ) ;</span>
<span class="fc" id="L663">        JPanel iconPanel = new JPanel() ;</span>
<span class="fc" id="L664">        JLabel label = new JLabel( icon , JLabel.CENTER ) ;</span>
<span class="fc" id="L665">        iconPanel.add( label , BorderLayout.CENTER ) ;</span>
<span class="fc" id="L666">        iconPanel.setBorder( new BevelBorder( BevelBorder.RAISED )) ;</span>
       
<span class="fc" id="L668">        helpDialog.getContentPane().add(  iconPanel , BorderLayout.CENTER ) ;</span>
<span class="fc" id="L669">        helpDialog.getContentPane().add( getCloseButtonPanel( helpDialog ) , BorderLayout.SOUTH ) ;</span>
<span class="fc" id="L670">        helpDialog.pack() ;</span>
<span class="fc" id="L671">        helpDialog.setVisible( true ) ;</span>
<span class="fc" id="L672">    }</span>
    
    public JPanel getCloseButtonPanel( final JDialog dialog )
    {
<span class="fc" id="L676">         JButton okButton = new JButton( &quot;OK&quot; ) ;</span>
<span class="fc" id="L677">        okButton.setMnemonic('O') ;</span>
<span class="fc" id="L678">        okButton.addActionListener( new ActionListener()</span>
        {
            public void actionPerformed( ActionEvent e )
            {
<span class="fc" id="L682">                dialog.dispose() ;</span>
<span class="fc" id="L683">            }</span>
        } ) ;
<span class="fc" id="L685">        JPanel closeButtonPanel = new JPanel() ;</span>
<span class="fc" id="L686">        closeButtonPanel.add( okButton ) ;</span>
<span class="fc" id="L687">        closeButtonPanel.setBorder( new BevelBorder( BevelBorder.RAISED )) ;</span>
<span class="fc" id="L688">        return closeButtonPanel ;</span>
    }
    
    public boolean analyseResult()
    {
<span class="fc" id="L693">        boolean result = true ;</span>
<span class="pc bpc" id="L694" title="1 of 4 branches missed.">        for( int i = 0 ; i &lt; noOfCells - 1 &amp;&amp; result ; i++ )</span>
        {
<span class="fc bfc" id="L696" title="All 2 branches covered.">            if( matrix[i] != i+1 )</span>
            {
<span class="fc" id="L698">                result = false ;</span>
            }
        }
<span class="fc" id="L701">        return result ;</span>
    }
    
    public JLabel getComponentIfPossibleToMove( int pos )
    {
<span class="fc" id="L706">        Component comp = null ;</span>
<span class="fc" id="L707">        JLabel label = null ;</span>
<span class="pc bpc" id="L708" title="1 of 4 branches missed.">        for( int i = 0 ; i &lt;= 3 &amp;&amp; label == null ; i++ )</span>
        {
<span class="fc" id="L710">            comp = getComponent( i , pos ) ;</span>
<span class="fc bfc" id="L711" title="All 2 branches covered.">            if( comp instanceof JLabel )</span>
            {
<span class="fc" id="L713">                label = ( JLabel ) comp ;</span>
            }
        }
<span class="fc" id="L716">        return label ;</span>
    }
    
    public boolean isPositionNotLeft( int pos )
    {
<span class="fc" id="L721">        boolean guess = true ;</span>
<span class="fc bfc" id="L722" title="All 4 branches covered.">        for( int i = 0 ; i &lt; level &amp;&amp; guess ; i++ )</span>
        {
<span class="fc bfc" id="L724" title="All 2 branches covered.">            if( pos == ( i * level ) )</span>
            {
<span class="fc" id="L726">                guess = false ;</span>
            }
        }
<span class="fc" id="L729">        return guess ;</span>
    }
    
    public boolean isPositionNotRight( int pos )
    {
<span class="fc" id="L734">        boolean guess = true ;</span>
<span class="fc bfc" id="L735" title="All 4 branches covered.">        for( int i = 0 ; i &lt; level &amp;&amp; guess ; i++ )</span>
        {
<span class="fc bfc" id="L737" title="All 2 branches covered.">            if( pos == ( ( i + 1 ) * level ) - 1 )</span>
            {
<span class="fc" id="L739">                guess = false ;</span>
            }
        }
<span class="fc" id="L742">        return guess ;</span>
    }
    
    public boolean isPositionNotTop( int pos )
    {
<span class="fc" id="L747">        boolean guess = true ;</span>
<span class="fc bfc" id="L748" title="All 4 branches covered.">        for( int i = 0 ; i &lt; level &amp;&amp; guess ; i++ )</span>
        {
<span class="fc bfc" id="L750" title="All 2 branches covered.">            if( pos == i )</span>
            {
<span class="fc" id="L752">                guess = false ;</span>
            }
        }
<span class="fc" id="L755">        return guess ;</span>
    }
    
    public boolean isPositionNotBottom( int pos )
    {
<span class="fc" id="L760">        boolean guess = true ;</span>
<span class="fc bfc" id="L761" title="All 4 branches covered.">        for( int i = 0 ; i &lt; level &amp;&amp; guess ; i++ )</span>
        {
<span class="fc bfc" id="L763" title="All 2 branches covered.">            if( pos == ( i + ( level * (level-1) ) ) )</span>
            {
<span class="fc" id="L765">                guess = false ;</span>
            }
        }
<span class="fc" id="L768">        return guess ;</span>
    }
    
    public Component getComponent( int position , int cp )
    {
<span class="fc" id="L773">        Component component = null ;</span>
<span class="fc bfc" id="L774" title="All 5 branches covered.">        switch( position )</span>
        {
            case LEFT :
            {
<span class="fc bfc" id="L778" title="All 2 branches covered.">                if( isPositionNotLeft( cp ) )</span>
                {
<span class="fc" id="L780">                    component = buttonPanel.getComponent( cp - 1 ) ;</span>
                }
<span class="fc" id="L782">                break ;</span>
            }
            case RIGHT :
            {
<span class="fc bfc" id="L786" title="All 2 branches covered.">                if( isPositionNotRight( cp ) )</span>
                {
<span class="fc" id="L788">                    component = buttonPanel.getComponent( cp + 1 ) ;</span>
                }
<span class="fc" id="L790">                break ;</span>
            }
            case TOP :
            {
<span class="fc bfc" id="L794" title="All 2 branches covered.">                if( isPositionNotTop( cp ) )</span>
                {
<span class="fc" id="L796">                    component = buttonPanel.getComponent( cp - level ) ;</span>
                }
<span class="fc" id="L798">                break ;</span>
            }
            case BOTTOM :
            {
<span class="fc bfc" id="L802" title="All 2 branches covered.">                if( isPositionNotBottom( cp ) )</span>
                {
<span class="fc" id="L804">                    component = buttonPanel.getComponent( cp + level ) ;</span>
                }
                break ;
            }
        }
<span class="fc" id="L809">        return component ;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Java03_Shuffle (Jan 16, 2022 9:29:23 PM)</div></body></html>